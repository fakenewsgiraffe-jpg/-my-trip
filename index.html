<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traveler's Tool - Stable Edition</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
    <style>
        /* 地図が表示されない問題を回避するための最低限のスタイル */
        #map { width: 100%; height: 100vh; background: #000; }
        /* タブの切り替えを確実に見せるための設定 */
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
    <div id="map"></div>
    <button id="toggle-panel" onclick="togglePanel()">≫</button>

    <aside id="side-panel">
        <nav class="panel-tabs">
            <button id="tab-btn-main" class="tab-btn active" onclick="switchTab('main')">ダイスログ</button>
            <button id="tab-btn-transit" class="tab-btn" onclick="switchTab('transit')">路線図</button>
            <button id="tab-btn-album" class="tab-btn" onclick="switchTab('album')">情報</button>
        </nav>

        <div class="panel-main">
            <section id="tab-main" class="tab-content active">
                <div id="chat-log"></div>
            </section>

            <section id="tab-transit" class="tab-content">
                <div class="transit-card">
                    <header>ROUTE SEARCH</header>
                    <div class="info-group">
                        <label>FROM</label><input type="text" id="st-from" class="st-input" placeholder="出発駅">
                        <label style="margin-top:8px">TO</label><input type="text" id="st-to" class="st-input" placeholder="到着駅">
                    </div>
                    <button class="search-btn" onclick="searchRoute()">経路検索表示</button>
                    <div id="route-res" class="data-value">データ読み込み中...</div>
                </div>
            </section>

            <section id="tab-album" class="tab-content">
                <div id="pos-display">地図をクリックして地点を選択</div>
                <div id="drop-zone">写真をドロップ</div>
                <div id="album-grid"></div>
                <button class="clear-btn" onclick="clearData()">リセット</button>
            </section>
        </div>

        <div class="dice-input-wrapper">
            <input type="text" id="user-name" value="noname">
            <div class="input-main">
                <textarea id="dice-command" placeholder="Enter×2で送信"></textarea>
                <button id="send-btn" onclick="rollDice()">送信</button>
            </div>
        </div>
    </aside>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
